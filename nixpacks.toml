[variables]
    NIXPACKS_PHP_ROOT_DIR = '/app/public'

[phases.setup]
    # On utilise 'php82' (fpm est inclus dedans) et on retire l'erreur
    nixPkgs = ['php82', 'nginx', 'nodejs_20', 'php82Packages.composer']

[phases.build]
    cmds = [
        'composer install --no-dev --optimize-autoloader',
        'npm ci',
        'npm run build'
    ]

[start]
    # Commande standard pour d√©marrer PHP et Nginx sans doublon
    cmd = "php-fpm -D && nginx -g 'daemon off;'"
